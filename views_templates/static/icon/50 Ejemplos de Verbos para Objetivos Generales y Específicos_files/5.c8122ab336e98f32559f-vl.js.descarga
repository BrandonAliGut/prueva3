(window.avntsWebpackJsonp=window.avntsWebpackJsonp||[]).push([[5],{172:function(t,n,e){"use strict";e.r(n);var r=e(0),i=e(1),a="__uspapi",o="__uspapiLocator",u="getUSPData",s=1,c="__uspapiCall",l="__uspapiReturn",d=function(t){return t?{uspString:t.uspString}:void 0},v=function(t){if(!t)return 1;var n=null==t?void 0:t.uspString;return"string"==typeof n&&4===n.length&&"Y"===n[2]?2:3},f=function(t,n){return new Promise((function(e){try{t===i.a.safeFrame?h(e,n):p(e,n)}catch(t){}}))},p=function(t,n){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(r){try{(e=globalThis[a]||globalThis.parent[a])||t(void 0),e(u,s,(function(e){var r=d(e);t(r),n(v(r))}))}catch(n){t(void 0)}return[2]}))}))},h=function(t,n){return Object(r.b)(this,void 0,void 0,(function(){var e,i,a,f;return Object(r.d)(this,(function(r){try{window.parent.frames[o]||t(void 0),e=""+Math.random(),(f={})[c]={callId:e,command:u,version:s},i=f,a=function(r){try{var i=("string"==typeof r.data&&r.data.includes(l)?JSON.parse(r.data):r.data)[l];if((null==i?void 0:i.callId)===e){globalThis.removeEventListener("message",a,!1);var o=d(i.returnValue);t(o),n(v(o))}}catch(n){t(void 0)}},globalThis.addEventListener("message",a,!1),globalThis.parent.postMessage(i,"*")}catch(n){t(void 0)}return[2]}))}))},g=(e(15),"cmpuishown"),E={CMP:"__cmp",LOCATOR:"__cmpLocator",GET_CONSENT_DATA:"getConsentData",VERSION:null,SAFE_FRAME_CALL:"__cmpCall",SAFE_FRAME_RETURN:"__cmpReturn",TIMEOUT:1e3,RETRIES:30},T={TCFAPI:"__tcfapi",LOCATOR:"__tcfapiLocator",VERSION:2,SAFE_FRAME_CALL:"__tcfapiCall",SAFE_FRAME_RETURN:"__tcfapiReturn"},b=function(t){return t?{gdpr:t.gdprApplies,consentString:t.tcString||t.consentString,status:t.eventStatus,purpose:t.purpose}:void 0},_=function(t){var n;return t?(null==t?void 0:t.gdprApplies)&&(null===(n=t.purpose)||void 0===n?void 0:n.consents)&&!t.purpose.consents[1]?2:3:1},A=function(t){try{if(t===i.a.safeFrame){if(window.parent.frames[T.LOCATOR])return m;if(window.parent.frames[E.LOCATOR])return C}else{if(globalThis[T.TCFAPI]||globalThis.parent[T.TCFAPI])return O;if(globalThis[E.CMP]||globalThis.parent[E.CMP])return S}}catch(t){}},R=function(t,n,e){return Object(r.b)(this,void 0,void 0,(function(){var i,a,o,u;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(i=A(n))?(a=[],t.config.waitForConsent||(o=function(t,n){var e;return new Promise((function(r){try{t(r,(function(t,i,a){e=b(t),r(e),null==a||a(t),n(_(t))}))}catch(t){r(e)}}))}(i,e),a.push(o)),u=function(t,n,e){return new Promise((function(r){var i;try{n(r,(function(n,a,o){i=b(n),t.app.logger.info("need user consent: ",t.config.waitForConsent);var u=(null==n?void 0:n.eventStatus)===g;(null==i?void 0:i.gdpr)&&u?null==a||a():(null==o||o(n),r(i),e(_(n)))}))}catch(t){r(i)}}))}(t,i,e),a.push(u),[4,Promise.race(a)]):(e(1),[2,void 0]);case 1:return[2,r.sent()]}}))}))},O=function(t,n){return Object(r.b)(this,void 0,void 0,(function(){var e,i;return Object(r.d)(this,(function(r){try{(e=globalThis[T.TCFAPI]||globalThis.parent[T.TCFAPI])||t(void 0),i=function(t){e("removeEventListener",2,(function(){}),null==t?void 0:t.listenerId)},e("addEventListener",2,(function(t){n(t,void 0,i)}))}catch(n){t(void 0)}return[2]}))}))},m=function(t,n){return Object(r.b)(this,void 0,void 0,(function(){var e,i,a,o,u,s;return Object(r.d)(this,(function(r){try{e=T,i=""+Math.random(),(s={})[e.SAFE_FRAME_CALL]={callId:i,command:"addEventListener",version:e.VERSION},a=s,o=function(r){try{var a=("string"==typeof r.data&&r.data.includes(e.SAFE_FRAME_RETURN)?JSON.parse(r.data):r.data)[e.SAFE_FRAME_RETURN];(null==a?void 0:a.callId)===i&&n(a.returnValue,void 0,u)}catch(n){t(void 0)}},u=function(){globalThis.removeEventListener("message",o,!1)},globalThis.addEventListener("message",o,!1),globalThis.parent.postMessage(a,"*")}catch(n){t(void 0)}return[2]}))}))},S=function(t,n){return Object(r.b)(this,void 0,void 0,(function(){var e,i,a,o,u;return Object(r.d)(this,(function(r){e=E.RETRIES;try{(a=globalThis[E.CMP]||globalThis.parent[E.CMP])||t(void 0),o=function(){0==--e?t(b(i)):setTimeout((function(){u()}),E.TIMEOUT)},(u=function(){a(E.GET_CONSENT_DATA,E.VERSION,(function(t){i=t,n(t,o)}))})()}catch(n){t(void 0)}return[2]}))}))},C=function(t,n){return Object(r.b)(this,void 0,void 0,(function(){var e,i,a,o,u,s,c,l;return Object(r.d)(this,(function(r){o=(e=E).RETRIES;try{u=function(r){try{var o=("string"==typeof r.data&&r.data.includes(e.SAFE_FRAME_RETURN)?JSON.parse(r.data):r.data)[e.SAFE_FRAME_RETURN];(null==o?void 0:o.callId)===i&&(a=o.returnValue,n(o.returnValue,c,s))}catch(n){t(void 0)}},s=function(){globalThis.removeEventListener("message",u,!1)},c=function(){0==--o?t(b(a)):setTimeout((function(){return l()}),E.TIMEOUT)},globalThis.addEventListener("message",u,!1),(l=function(){var t;i=""+Math.random();var n=((t={})[e.SAFE_FRAME_CALL]={callId:i,command:e.GET_CONSENT_DATA,version:e.VERSION},t);globalThis.parent.postMessage(n,"*")})()}catch(n){t(void 0)}return[2]}))}))},F=e(14);n.default=function(t){var n=this;return function(e,i){return Object(r.b)(n,void 0,void 0,(function(){var n,a,o,u,s,c;return Object(r.d)(this,(function(l){switch(l.label){case 0:return"aniview"!==e.config.playerProvider?[3,4]:i?[4,i()]:[3,2];case 1:return n=l.sent(),[3,3];case 2:n={},l.label=3;case 3:return[2,n];case 4:return l.trys.push([4,11,,12]),[4,Object(F.d)()];case 5:return o=l.sent(),u=function(t){return function(n){t.app.logger.debug("user consent: "+n),t.state.consentStatus=n}}(e),function(t){var n;return"US"===(null===(n=t.country)||void 0===n?void 0:n.toUpperCase())}(o)?[4,f(t,u)]:[3,7];case 6:return a=l.sent(),[3,10];case 7:return function(t){var n;return t.eu||"BR"===(null===(n=t.country)||void 0===n?void 0:n.toUpperCase())}(o)?[4,R(e,t,u)]:[3,9];case 8:return a=l.sent(),[3,10];case 9:e.state.consentStatus=1,l.label=10;case 10:return[3,12];case 11:return s=l.sent(),e.app.logger.error("consent middleware: ",null==s?void 0:s.message),[3,12];case 12:return e.state.userConsent=Object(r.a)({uspString:"1---"},a),i?[4,i()]:[3,14];case 13:return c=l.sent(),[3,15];case 14:c={},l.label=15;case 15:return[2,c]}}))}))}}}}]);